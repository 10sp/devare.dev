import{k as e,R as M,r as f}from"./core-BQ9oUMX2.js";import{u as p,h as L,$ as O,aP as N,aQ as V,aR as A,a3 as K,aS as W,aT as T}from"./index-7MWe1d52.js";import{s as F,v as z,z as H,K as _,A as q,c as D,D as Q,w as U,B as $,q as G,C as X}from"./ui-BLpkT4OS.js";import"./utils-ZVqEcU1h.js";import{a as J,b as Y,C as I}from"./index-Ch3uFP3w.js";import"./CardIcon-p56f0ZM1.js";const Z=({selectedCard:s,setSelectedCard:o})=>{const{cards:n,userCustomCards:m}=p(),d=[...L,...m];return e.jsx("div",{className:"bottomNavigation",children:n.map(r=>{const a=d.find(u=>u.value===r.name);return e.jsx("button",{className:"navigationItem "+(s&&s.name===r.name?"active":""),onClick:()=>o(r),children:M.isValidElement(a==null?void 0:a.icon)?a.icon:typeof(a==null?void 0:a.icon)=="string"?e.jsx("img",{src:a.icon,alt:""}):e.jsx(O,{className:"rss"})},r.name)})})},ee=()=>{const{cards:s}=p(),[o,n]=f.useState(!1),[m,d]=f.useState(!1),r=f.useRef(null),a="Cards",u=i=>{const g=i.target;if(g.classList.contains(a))if(s.length<=N)n(!1),d(!1);else{const{scrollLeft:v,scrollWidth:b,offsetWidth:S}=g;n(v>100);const t=b-S-Math.abs(v);d(t>100)}},C=f.useCallback(i=>{i.key==="ArrowLeft"?h("left"):i.key==="ArrowRight"&&h("right")},[]);f.useLayoutEffect(()=>{r.current=document.querySelector(`.${a}`)},[]),f.useEffect(()=>{var i;return(i=r.current)==null||i.addEventListener("scroll",u,!0),window.addEventListener("keydown",C),()=>{var g;window.removeEventListener("keydown",C),(g=r.current)==null||g.removeEventListener("scroll",u)}},[C]),f.useEffect(()=>{d(s.length>N)},[s]);const h=i=>{var S,t;if(!r.current)return;V(i);const{scrollLeft:g}=r.current,{offsetWidth:v}=(t=(S=r.current)==null?void 0:S.firstChild)==null?void 0:t.firstChild,b=i==="left"?g-v:g+v;r.current.scrollTo({left:b,behavior:"smooth"})};return e.jsxs("div",{className:"scrollCardsNavigator",children:[o&&e.jsx("button",{"aria-label":"Previous cards",className:"scrollButton",onClick:()=>h("left"),style:{left:0},children:e.jsx(J,{size:32})}),m&&e.jsx("button",{"aria-label":"Next cards",className:"scrollButton",onClick:()=>h("right"),style:{right:0},children:e.jsx(Y,{size:32})})]})},P=({children:s})=>A({minWidth:768})?s:null,se=({children:s})=>A({maxWidth:767})?s:null,te=({id:s,card:o})=>{const{attributes:n,listeners:m,setNodeRef:d,isDragging:r,transform:a,transition:u}=G({id:s}),{isOrganizeMode:C}=p(),h={transform:X.Transform.toString(a),transition:u},i=o.component||I;return e.jsx("div",{ref:d,style:h,className:D(C&&"grid-item"),children:e.jsx(i,{meta:o,className:D(r&&"draggedBlock",C&&"organize-item"),knob:e.jsx(P,{children:e.jsx("button",{className:"blockHeaderDragButton",...n,...m,children:e.jsx(T,{})})})})})},ne=({cards:s,userCustomCards:o})=>{const n=[...L,...o],{updateCardOrder:m,isOrganizeMode:d,setIsOrganizeMode:r,setCards:a}=p(),u=f.useRef(null),{adsConfig:C}=K(),h=F(z(q),z(_,{coordinateGetter:H})),i=()=>{var t;(t=u.current)==null||t.classList.add("snapDisabled")},g=t=>{var j;const{active:c,over:l}=t;if(c.id!==(l==null?void 0:l.id)){const y=s.findIndex(x=>x.name===c.id),E=s.findIndex(x=>x.name===(l==null?void 0:l.id));y!==-1&&E!==-1&&(m(y,E),W())}(j=u.current)==null||j.classList.remove("snapDisabled")},v=t=>{if(!u.current)return;const c=u.current,{clientX:l}=t,{left:j,right:y,width:E}=c.getBoundingClientRect(),x=E*.1,R=j+x,B=y-x,w=10;if(l<R){const k=(R-l)/x;c.scrollBy({left:-w*k,behavior:"smooth"})}else if(l>B){const k=(l-B)/x;c.scrollBy({left:w*k,behavior:"smooth"})}},b=f.useMemo(()=>s.map(t=>{const c=n.find(l=>l.value===t.name);return c?{card:c,id:t.name}:null}).filter(Boolean),[s]);f.useEffect(()=>{const t=c=>{c.key==="Escape"&&d&&(r(!1),document.documentElement.classList.remove("organizeMode"))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[d,r]);const S=()=>{r(!1),document.documentElement.classList.remove("organizeMode")};return e.jsxs("div",{ref:u,className:D("Cards","HorizontalScroll",d&&"grid-layout"),children:[d&&e.jsxs("div",{className:"organize-mode-header",children:[e.jsx("h2",{children:"Organize Cards"}),e.jsx("p",{children:"Drag and drop cards to reorder them. Press ESC to exit."}),e.jsx("button",{className:"exit-organize-mode",onClick:S,children:"Exit Organize Mode"})]}),e.jsx(Q,{sensors:h,autoScroll:!0,onDragEnd:g,onDragStart:i,onDragMove:v,children:e.jsx(U,{items:b.map(({id:t})=>t),strategy:$,children:b.map(({id:t,card:c},l)=>e.jsx(te,{id:t,card:c},t))})})]})},re=({selectedCard:s})=>{const{userCustomCards:o}=p(),n=[...L,...o].find(m=>m.value===s.name);return n?M.createElement((n==null?void 0:n.component)||I,{key:n.value,meta:n}):null},ue=()=>{const{cards:s,userCustomCards:o}=p(),[n,m]=f.useState(s[0]);return e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(P,{children:e.jsx(ne,{cards:s,userCustomCards:o})}),e.jsx(se,{children:e.jsx("div",{className:"Cards HorizontalScroll",children:e.jsx(re,{selectedCard:n})})}),e.jsx(Z,{selectedCard:n,setSelectedCard:m})]})};export{ue as CardsLayout};
//# sourceMappingURL=CardsLayout-DM9Ksb-e.js.map
