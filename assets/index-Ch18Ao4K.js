import{u as x,at as y,aL as _,aM as R,aN as E}from"./index-CcP7eB5b.js";import{r as f,k as d}from"./core-Dpo8Q2SY.js";import"./utils-B4k-6dfN.js";import"./ui-CRwGqcgo.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b38b2e07-3a00-4d1e-b716-76d5fd5ff42c",e._sentryDebugIdIdentifier="sentry-dbid-b38b2e07-3a00-4d1e-b716-76d5fd5ff42c")}catch{}function I(){const e=new Map;function n({root:a,rootMargin:c,threshold:i}){let s=e.get(a);s||(s=new Map,e.set(a,s));const l=JSON.stringify({rootMargin:c,threshold:i});let o=s.get(l);if(!o){const t=new Map;o={observer:new IntersectionObserver(v=>{v.forEach(r=>{const u=t.get(r.target);u==null||u(r)})},{root:a,rootMargin:c,threshold:i}),entryCallbacks:t},s.set(l,o)}return{observe:(t,b)=>{o.entryCallbacks.set(t,b),o.observer.observe(t)},unobserve:t=>{o.entryCallbacks.delete(t),o.observer.unobserve(t)}}}return{getObserver:n}}var N="0px",O=[0],k=I();function L(e){const n=(e==null?void 0:e.rootMargin)??N,a=(e==null?void 0:e.threshold)??O,c=f.useRef(null),i=f.useRef(null),s=f.useRef(null),[l,o]=f.useState(),t=f.useCallback(()=>{function r(){const g=s.current,p=c.current;p&&(g==null||g.unobserve(p),o(void 0)),s.current=null}function u(){const g=c.current;if(!g)return;const p=k.getObserver({root:i.current,rootMargin:n,threshold:a});p.observe(g,m=>{o(m)}),s.current=p}r(),u()},[n,a]),b=f.useCallback(r=>(c.current=r,t(),()=>{c.current=null,t()}),[t]),v=f.useCallback(r=>(i.current=r,t(),()=>{i.current=null,t()}),[t]);return[b,{entry:l,rootRef:v}]}var w=L;function C(e){var t;const{once:n,...a}=e??{},[c,i]=w(a),s=!!((t=i.entry)!=null&&t.isIntersecting),[l,o]=f.useState(s);return n&&s&&!l&&o(!0),[c,{...i,isVisible:n?l:s}]}var T=C,j=100;function D({loading:e,hasNextPage:n,onLoadMore:a,rootMargin:c,disabled:i,delayInMs:s=j}){const l=f.useRef(a),[o,{rootRef:t,isVisible:b}]=T({rootMargin:c});f.useEffect(()=>{l.current=a},[a]);const v=!i&&!e&&b&&n;return f.useEffect(()=>{if(v){const r=setTimeout(()=>{l.current()},s);return()=>{clearTimeout(r)}}},[v,s]),[o,{rootRef:t}]}var S=D;const V=()=>{const{userSelectedTags:e}=x(),{data:n,isLoading:a,isInitialLoading:c,hasNextPage:i,isError:s,error:l,isFetchingNextPage:o,fetchNextPage:t}=y({tags:e.map(r=>r.label.toLocaleLowerCase()),config:{select:r=>({...r,pages:r.pages.map((u,g)=>{const p=u.data,m=[];return p.forEach((h,F)=>{m.push(h)}),{...u,data:m}})})}}),[b,{rootRef:v}]=S({loading:a,hasNextPage:!!i,onLoadMore:()=>{t(),E()},disabled:!!l,rootMargin:"0px 0px 100% 0px"});return c?d.jsx("div",{className:"feed",children:Array.from({length:10}).map((r,u)=>d.jsxs("div",{className:"feedItem placeholder",children:[d.jsx("div",{className:"image"}),d.jsx("div",{className:"line"}),d.jsx("div",{className:"smallLine"})]},`loading-${u}`))}):d.jsxs("div",{ref:v,className:"feed scrollable",style:{overflow:"auto",maxHeight:"100%"},children:[((n==null?void 0:n.pages.flatMap(r=>r.data))||[]).map((r,u)=>d.jsx(_,{item:r,index:u,analyticsTag:"feed",className:"feedItem"},r.id)),i&&d.jsx("div",{className:"feedLoading",ref:b,children:d.jsx(R.PropagateLoader,{color:"#A9B2BD",loading:!0,size:8})}),o&&s&&d.jsx("div",{children:"Error while loading more pages"})]})};export{V as Feed,_ as FeedItem,y as useGetFeed};
//# sourceMappingURL=index-Ch18Ao4K.js.map
