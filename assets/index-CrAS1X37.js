import{k as e,r as x,g as be,m as ke,o as ye,i as ce}from"./core-BQ9oUMX2.js";import{M as ae,b as I,g as we,t as V,c as De,d as Re,r as re,e as Ee,p as Ae,f as de,u as T,h as se,j as W,C as Fe,k as Ie,m as Te,n as Le,o as Me,q as te,v as Ue,w as $e,F as Be,x as Pe,y as Oe,I as Ve,z as ze,D as _e,E as He,G as Ge,J as ue,K as me,L as Ye,N as Je,O as We,P as qe,Q as Ke,R as Qe,T as Xe,U as Ze,A as he,V as es,W as ss,X as ts,H as as,Y as pe,Z as ns,$ as ls,a0 as rs,a1 as os,a2 as is,a3 as cs,a4 as ds,a5 as us}from"./index-7MWe1d52.js";import{R as ms,a as hs,b as ps,C as K,c as fs}from"./ChipsSet-F0ltKDXB.js";import{t as q,n as gs,S as fe,G as xs,o as ge}from"./ui-BLpkT4OS.js";import"./DNDLayout-quTYwcRd.js";import"./utils-ZVqEcU1h.js";import{C as oe}from"./CustomContentRssCard-Bpq4ZfYB.js";import{g as xe}from"./CardIcon-p56f0ZM1.js";const Q=({showModal:s,title:o,description:a,onClose:l,onConfirm:t})=>e.jsx(ae,{showModal:s,onClose:l,header:{title:o,className:void 0,icon:void 0},className:"confirmModal",children:e.jsxs("div",{className:"content",children:[e.jsx("p",{className:"description",children:a}),e.jsxs("div",{className:"buttons",children:[e.jsx(I,{onClick:l,size:"medium",children:"Cancel"}),e.jsx(I,{onClick:t,size:"medium",children:"Confirm"})]})]})}),js=()=>{const s=we();return e.jsxs("footer",{className:"AppFooter",children:[e.jsxs("a",{className:"linkItem",href:De,onClick:()=>V("Feature Request"),children:[e.jsx(Re,{className:"linkItemIcon"})," New Feature?"]}),e.jsxs("a",{className:"linkItem",href:re,target:"_blank",onClick:()=>V("Source Code"),rel:"noreferrer",children:[e.jsx(ms,{className:"linkItemIcon"})," Source code"]}),e.jsx("a",{className:"linkItem",href:Ee,onClick:()=>V("Terms And Conditions"),children:"Terms & conditions"}),e.jsx("a",{className:"linkItem",href:Ae,onClick:()=>V("Privacy Policy"),children:"Privacy policy"}),s&&e.jsxs("a",{className:"linkItem",href:re,target:"_blank",rel:"noreferrer",onClick:()=>V("Source Code"),children:["v",s]})]})},z=({title:s,description:o,actions:a,children:l})=>e.jsxs("div",{className:"settingsContent",children:[e.jsxs("header",{children:[e.jsxs("div",{className:"settingsHeader",children:[e.jsx("h1",{className:"title",children:s}),e.jsx("p",{className:"description",children:o})]}),a&&e.jsx("div",{className:"actions",children:a})]}),e.jsx("main",{className:"settingsBody scrollable",children:l})]}),vs=({item:s,appendRef:o=!1})=>{const{unbookmarkPost:a}=de(),{userCustomCards:l}=T(),r=[...se,...l].find(d=>d.value===s.source),i={[W.TRIGERED_FROM]:"bookmarks",[W.TITLE]:s.title,[W.LINK]:s.url,[W.SOURCE]:s.source},c=()=>{a(s),Le(i),q("Link removed from the bookmarks",{theme:"defaultToast"})};return e.jsxs("div",{className:"bookmarkItem",children:[e.jsxs(Fe,{className:"body",link:s.url,appendRef:o,analyticsAttributes:i,children:[e.jsx("div",{className:"title",children:s.title}),r&&e.jsxs("div",{className:"source",children:[r.type==="supported"?e.jsx("span",{className:"icon",children:r.icon}):e.jsx("img",{className:"icon",src:r.icon,alt:""}),e.jsx("span",{children:r.label})]})]}),e.jsx("div",{className:"actions",children:e.jsx("button",{className:"btn","aria-label":"Remove from bookmarks",onClick:c,children:e.jsx(Ie,{})})})]})},Ys=()=>{const s=x.useRef(null),{initState:o,userBookmarks:a}=de(),l=()=>{var i;(i=s.current)==null||i.click()},t=()=>{const i=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),c=URL.createObjectURL(i),d=document.createElement("a");d.href=c,d.download="devareBookmarks",d.click()},r=i=>{var d;const c=(d=i.target.files)==null?void 0:d[0];if(c){const u=new FileReader;u.onload=()=>{const h=JSON.parse(u.result).filter(p=>p.title&&p.url&&!a.some(v=>v.title===p.title&&v.url===p.url)).map(p=>({title:p.title,url:p.url,source:p.source||"",sourceType:p.sourceType||""}));o({userBookmarks:[...a,...h]}),q("Your bookmarks have been successfully imported",{theme:"defaultToast"})},u.readAsText(c)}};return e.jsx(e.Fragment,{children:e.jsx(z,{title:"Bookmarks",description:"Find all your bookmarks here. You can remove a bookmark by clicking on the remove icon.",actions:e.jsxs("div",{className:"buttonsFlex",children:[e.jsx("input",{type:"file",id:"file",ref:s,accept:"application/json",className:"hidden",onChange:r}),e.jsxs(I,{onClick:l,children:[e.jsx(hs,{}),"Import"]}),e.jsx(Te,{onClick:()=>t(),children:e.jsx(ps,{})})]}),children:e.jsx("div",{className:"bookmarks",children:a.map(i=>e.jsx(vs,{item:i},i.url))})})})};var Ss=gs();const Z=be(Ss),Cs=({userId:s})=>Me.delete(`/engine/user/${s}`,{}),Ns=({config:s}={})=>ke({...s,mutationFn:Cs}),bs=()=>{const s=Ns(),{user:o,logout:a}=te(),[l,t]=x.useState(!1);if(!o)return null;const r=()=>{s.mutateAsync({userId:o.id}).then(()=>{a(),Ue(),q("Account deleted successfully",{theme:"successToast"})}).catch(()=>{q("Failed to delete account",{theme:"defaultToast"})})};return e.jsxs("div",{className:"settingRow",children:[e.jsxs("p",{className:"settingTitle",children:["Delete account?",e.jsx("br",{}),e.jsx("span",{className:"settingHint",children:"This action is irreversible and will delete all your data. Proceed with caution."})]}),e.jsxs("div",{className:"settingContent",children:[e.jsx(Q,{showModal:l,title:"Confirm delete account",description:"Are you sure you want to delete your account? This action is irreversible and will delete all your data including your streaks and settings.",onClose:()=>t(!1),onConfirm:r}),e.jsx(I,{size:"small",onClick:()=>t(!0),isLoading:s.isLoading,children:"Delete account"})]})]})},ks=(s,o,a="s")=>`${s} ${o}${s!==1?a:""}`,ys=()=>{const{user:s}=te(),{logout:o,providerId:a,openAuthModal:l}=te(),t=(a==null?void 0:a.split(".")[0])||"Unknown",[r,i]=x.useState(!1);return s?e.jsxs("div",{className:"userContent",children:[e.jsx(Q,{showModal:r,title:"Confirm logout",description:"Are you sure you want to logout?",onClose:()=>i(!1),onConfirm:o}),e.jsxs("div",{className:"userDetails",children:[(s==null?void 0:s.imageURL)&&e.jsx("img",{src:s.imageURL,className:"userImage"}),e.jsxs("div",{className:"userInfo",children:[e.jsx("div",{className:"userName",children:s.name}),e.jsxs("div",{className:"sub",children:[a=="github.com"?e.jsx(Be,{size:18}):a=="google.com"?e.jsx(Pe,{size:18}):null,"Connected with ",e.jsx("span",{className:"capitalize",children:t})]}),e.jsx("div",{className:"actions",children:e.jsx(I,{className:"logoutBtn",onClick:()=>i(!0),size:"small",children:"Logout"})})]})]}),e.jsxs("div",{className:"streaks",children:[e.jsxs("p",{className:"title",children:["You're on"," ",e.jsxs("span",{className:"highlight",children:[e.jsx(Oe,{className:"icon"})," ",ks(s.streak||1,"day")," streak"]})]}),e.jsx("div",{children:e.jsx("ul",{className:"streaksWeek",children:Array.from({length:5},(c,d)=>{const u=s.streak||1;return d<u?e.jsx("li",{className:"dayWrapper checked",children:e.jsx("span",{className:"day",children:e.jsx(Ve,{})})},`day-${d}`):e.jsx("li",{className:"dayWrapper",children:e.jsx("span",{className:"day"})},`day-${d}`)})})})]})]}):e.jsx("div",{className:"userContent",children:e.jsxs("div",{className:"userDetails",children:[e.jsx($e,{className:"userImage"}),e.jsxs("div",{className:"userInfo",children:[e.jsxs("div",{className:"userName",children:["Join ",e.jsx("b",{children:"devare"})]}),e.jsxs("div",{className:"description",children:["Create a free account on ",e.jsx("b",{children:"devare"})," to sync, save bookmarks, and earn rewards."]}),e.jsx("div",{className:"actions",children:e.jsx(I,{className:"logoutBtn",onClick:()=>l(),size:"small",children:"Connect"})})]})]})})},ws=()=>{const{maxVisibleCards:s,setMaxVisibleCards:o,layout:a}=T(),l=t=>{if(t.length){const r=parseInt(t[0].value);o(r),ze(r),_e(r)}};return a==="grid"?null:e.jsxs("div",{className:"settingRow",children:[e.jsx("p",{className:"settingTitle",children:"Max number of cards to display"}),e.jsxs("div",{className:"settingContent",children:[e.jsx(K,{className:"noMargin alternative-color",canSelectMultiple:!1,options:[{label:"3 cards",value:"3"},{label:"4 cards",value:"4"},{label:"5 cards",value:"5"},{label:"6 cards",value:"6"}],defaultValues:[s.toString()],onChange:(t,r)=>{l(r)}}),e.jsx("p",{className:"settingHint",children:"To ensure a seamless experience, we may adjust the selected number to align with the resolution of your screen."})]})]})},ee=[{value:15,label:"For 15 minutes"},{value:30,label:"For 30 minutes"},{value:60,label:"For 1 hour"},{value:"always",label:"Until you turn it off"}],Ds=()=>{const[s,o]=x.useState(),a=ye(),{DNDDuration:l,setDNDDuration:t}=T(),r=()=>{if(s){if(typeof s=="string")t(s);else{const u=s,j=new Date;j.setMinutes(j.getMinutes()+u),t({value:s,countdown:j.getTime()})}Ge(s),a("/")}},i=u=>{u&&o(u.value)},c=()=>{if(typeof l=="string")return ee.find(u=>u.value===l);if(typeof l=="object"){const u=l;return ee.find(j=>j.value===u.value)}},d=()=>{if(typeof l=="object"){const u=l,j=new Date(u.countdown),h=new Date;return`DND will turn off in ${He(j.getTime(),h.getTime())} Minutes`}};return e.jsxs("div",{className:"settingRow",children:[e.jsxs("p",{className:"settingTitle",children:["Do not disturb",e.jsx("br",{}),e.jsx("span",{className:"settingHint",children:"Pause devare for a period of time"})]}),e.jsxs("div",{className:"settingContent",children:[e.jsxs("div",{className:"form",children:[e.jsx("div",{style:{flex:1},children:e.jsx(fe,{options:ee,placeholder:"For x minutes",isMulti:!1,isClearable:!1,isSearchable:!1,defaultValue:c(),classNamePrefix:"devare",onChange:i})}),e.jsx(I,{size:"small",onClick:r,children:"Apply"})]}),d()&&e.jsx("div",{className:"settingHint",children:e.jsx("p",{children:d()})})]})]})},Rs=()=>{const{userSelectedTags:s,layout:o,theme:a,openLinksNewTab:l,listingMode:t,promptEngine:r,promptEngines:i,maxVisibleCards:c,cards:d,cardsSettings:u,userCustomCards:j,DNDDuration:h,onboardingCompleted:p,onboardingResult:v,firstSeenDate:C,isOrganizeMode:L,setTags:F,setLayout:B,setTheme:U,setOpenLinksNewTab:f,setListingMode:k,setPromptEngine:g,setMaxVisibleCards:w,setCards:n,setUserCustomCards:y,setDNDDuration:N,addSearchEngine:A,removeSearchEngine:m,setOnboardingCompleted:D,setFirstSeenDate:R,setIsOrganizeMode:E}=T(),[b,M]=x.useState(null),[P,_]=x.useState(null),ne=x.useRef(null),Se=()=>{try{const H=JSON.stringify({layout:o,theme:a,openLinksNewTab:l,listingMode:t,maxVisibleCards:c,DNDDuration:h,isOrganizeMode:L,cards:d,userCustomCards:j,userSelectedTags:s,promptEngine:r,promptEngines:i,cardsSettings:u,onboardingCompleted:p,onboardingResult:v,firstSeenDate:C},null,2),G="data:application/json;charset=utf-8,"+encodeURIComponent(H),Y=`devare-full-settings-${new Date().toISOString().slice(0,10)}.json`,O=document.createElement("a");O.setAttribute("href",G),O.setAttribute("download",Y),O.click(),_("All settings exported successfully!"),setTimeout(()=>_(null),3e3)}catch($){_("Error exporting settings: "+$.message),setTimeout(()=>_(null),5e3)}},Ce=$=>{var Y;const H=(Y=$.target.files)==null?void 0:Y[0];if(!H)return;const G=new FileReader;G.onload=O=>{var le;try{const X=(le=O.target)==null?void 0:le.result,S=JSON.parse(X);S.layout&&B(S.layout),S.theme&&U(S.theme),typeof S.openLinksNewTab=="boolean"&&f(S.openLinksNewTab),S.listingMode&&k(S.listingMode),typeof S.maxVisibleCards=="number"&&w(S.maxVisibleCards),S.DNDDuration&&N(S.DNDDuration),typeof S.isOrganizeMode=="boolean"&&E(S.isOrganizeMode),S.cards&&n(S.cards),S.userCustomCards&&y(S.userCustomCards),S.userSelectedTags&&F(S.userSelectedTags),S.promptEngines&&(i.forEach(J=>{m(J.url)}),S.promptEngines.forEach(J=>{A(J)})),S.promptEngine&&g(S.promptEngine),typeof S.onboardingCompleted=="boolean"&&D(S.onboardingCompleted),S.firstSeenDate&&R(S.firstSeenDate),S.cardsSettings&&Object.keys(S.cardsSettings).forEach(J=>{}),M("All settings imported successfully!"),setTimeout(()=>M(null),3e3)}catch(X){M("Error importing settings: "+X.message),setTimeout(()=>M(null),5e3)}},G.readAsText(H),$.target.value=""},Ne=()=>{var $;($=ne.current)==null||$.click()};return e.jsxs("div",{className:"settingRow",children:[e.jsx("p",{className:"settingTitle",children:"Import/Export All Settings"}),e.jsxs("div",{className:"settingContent",children:[e.jsxs("div",{className:"import-export-buttons",children:[e.jsx("input",{type:"file",accept:".json",onChange:Ce,style:{display:"none"},ref:ne,id:"import-settings-input"}),e.jsx(I,{startIcon:e.jsx(ue,{}),onClick:Ne,children:"Import Settings"}),e.jsx(I,{startIcon:e.jsx(me,{}),onClick:Se,children:"Export Settings"})]}),(b||P)&&e.jsx("div",{className:"settingHint",children:e.jsx("p",{children:b||P})})]})]})};function Es(s){return xs({attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M1 0h3v17h-3v-17zM5 17h3v-17h-3v17zM9 17h3v-17h-3v17zM13 0v17h3v-17h-3z"},child:[]}]})(s)}const ie=[{value:"grid",label:"AI Feed (Beta)",icon:e.jsx(fs,{color:"#F1D247"})},{value:"cards",label:"Cards",icon:e.jsx(Es,{})}],As=s=>e.jsx(ge.Option,{...s,children:e.jsxs("div",{className:"optionIcon",children:[s.data.icon,s.data.label]})}),Fs=s=>e.jsx(ge.SingleValue,{...s,children:e.jsxs("div",{className:"optionIcon",children:[s.data.icon,s.data.label]})}),Is=()=>{const{layout:s,setLayout:o}=T(),a=t=>{t&&(o(t.value),Ye(t.value),Je(t.value))},l=()=>ie.find(t=>t.value===s);return e.jsxs("div",{className:"settingRow",children:[e.jsx("p",{className:"settingTitle",children:"Layout Style"}),e.jsx("div",{className:"settingContent",children:e.jsx("div",{className:"form",children:e.jsx("div",{style:{flex:1},children:e.jsx(fe,{options:ie,components:{Option:As,SingleValue:Fs},isMulti:!1,isClearable:!1,isSearchable:!1,defaultValue:l(),classNamePrefix:"devare",onChange:a})})})})]})},Js=()=>{const{openLinksNewTab:s,listingMode:o,theme:a,maxVisibleCards:l,setTheme:t,setListingMode:r,setMaxVisibleCards:i,setOpenLinksNewTab:c}=T(),d=h=>{const p=h.target.checked;Ke(p),Qe(p),c(p)},u=h=>{const p=h.target.checked?"compact":"normal";Xe(p),Ze(p),r(p)},j=()=>{const h=a==="dark"?"light":"dark";t(h),We(h),qe(h)};return e.jsx(z,{title:"General Settings",description:"Customize your experience by selecting the number of cards you want to see, the search engine you want to use and more.",children:e.jsxs("div",{children:[e.jsx(ys,{}),e.jsx(Is,{}),e.jsx(ws,{}),e.jsxs("div",{className:"settingRow",children:[e.jsx("p",{className:"settingTitle",children:"Dark Mode"}),e.jsx("div",{className:"settingContent",children:e.jsx(Z,{checked:a==="dark",icons:!1,onChange:j})})]}),e.jsxs("div",{className:"settingRow",children:[e.jsx("p",{className:"settingTitle",children:"Open links in a new tab"}),e.jsx("div",{className:"settingContent",children:e.jsx(Z,{checked:s,icons:!1,onChange:d})})]}),e.jsxs("div",{className:"settingRow",children:[e.jsx("p",{className:"settingTitle",children:"Compact mode"}),e.jsx("div",{className:"settingContent",children:e.jsx(Z,{checked:o==="compact",icons:!1,onChange:u})})]}),e.jsx(Ds,{}),e.jsx(Rs,{}),e.jsx(bs,{}),e.jsx(js,{})]})})},je=s=>{var o=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,})(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return!!o.test(s)},Ts=()=>{const{addSearchEngine:s,promptEngines:o}=T(),[a,l]=x.useState(),[t,r]=x.useState(),i=[...he,...o],c=async()=>{if(!a){r("Please provide a valid Prompt engine URL");return}if(!je(a)){r("Invalid AI prompt Engine URL. Please check and try again");return}if(i.some(j=>j.url===a)){r("AI Prompt Engine already exists");return}const u=new URL(a).hostname.replace("www.","").split(".")[0];s({label:u,url:a,default:!1}),r("AI Prompt Engine added successfully")};return e.jsxs("div",{className:"settingRow",children:[e.jsx("p",{className:"settingTitle",children:"AI prompt Engine URL"}),e.jsxs("div",{className:"settingContent",children:[e.jsxs("div",{className:"form",children:[e.jsx("input",{type:"text",value:a||"",onChange:d=>l(d.target.value),placeholder:"https://chatgpt.com?q="}),e.jsx("div",{children:e.jsx(I,{startIcon:e.jsx(es,{}),size:"small",onClick:c,children:"Add"})})]}),t&&e.jsx("div",{className:"settingHint",children:e.jsx("p",{children:t})})]})]})},Ws=()=>{var c,d,u,j,h,p;const{promptEngines:s,promptEngine:o,removeSearchEngine:a,setPromptEngine:l}=T(),[t,r]=x.useState({showModal:!1,engine:void 0}),i=[...he,...s];return e.jsx(z,{title:"AI Prompt Engine",description:`
     Select from top AI models, input your prompt, and get quick responses. 
      You can also add a new ai model engine by providing its URL.
    `,children:e.jsxs(e.Fragment,{children:[e.jsx(Q,{showModal:t.showModal,title:`Confirm ${(c=t.engine)!=null&&c.isDefault?"removal":"deletion"} of engine: ${(d=t.engine)==null?void 0:d.label}`,description:`Are you sure you want to ${(u=t.engine)!=null&&u.isDefault?"remove":"delete"} the ${(j=t.engine)==null?void 0:j.label} engine? ${(h=t.engine)!=null&&h.isDefault?"You can add it back anytime.":"This action cannot be undone."}`,onClose:()=>r({showModal:!1,engine:void 0}),onConfirm:()=>{t.engine&&(a(t.engine.url),r({showModal:!1,engine:void 0}))}}),e.jsx(K,{canSelectMultiple:!1,options:i.map(v=>({label:v.label,value:v.url,removeable:!0,icon:(v==null?void 0:v.default)===!1?e.jsx(as,{}):e.jsx("img",{className:"lang_icon",src:`/searchengine_logos/${v.label.toLowerCase()}_logo.svg`})})),defaultValues:[((p=i.find(v=>v.label===o))==null?void 0:p.url)||""],onRemove:v=>{const C=i.find(L=>L.url===v.value);C&&r({showModal:!0,engine:{label:C.label,url:C.url,isDefault:C.default===!0}})},onChange:v=>{const C=v.option;ss(C.label),ts(C.label),l(C.label)}}),e.jsx("hr",{}),e.jsxs(e.Fragment,{children:[e.jsx("header",{children:e.jsxs("div",{className:"settingsHeader",children:[e.jsx("h3",{className:"title",children:"Add new AI prompt Engine"}),e.jsx("p",{className:"description",children:"Can't find your favorite AI prompt engine? Add it here and it."})]})}),e.jsx(Ts,{})]})]})})},ve=({isOpen:s,onClose:o,feed:a,existingCard:l})=>{const[t,r]=x.useState([]),[i,c]=x.useState({}),[d,u]=x.useState(!1),[j,h]=x.useState(null),{userCustomCards:p,setUserCustomCards:v,cards:C,setCards:L}=T();x.useEffect(()=>{s&&a.url&&F()},[s,a.url]),x.useEffect(()=>{if(l&&l.customContent&&t.length>0){const f={};t.forEach((g,w)=>{f[g.url]=w});const k={};l.customContent.forEach(g=>{const w=f[g.url];w!==void 0&&(k[w.toString()]=!0)}),c(k)}},[l,t]);const F=async()=>{u(!0),h(null);try{const f=await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(a.url)}`);if(!f.ok)throw new Error(`Failed to fetch RSS feed: ${f.status} ${f.statusText}`);const k=await f.json();if(k.status!=="ok")throw new Error(`RSS feed error: ${k.message}`);const g=k.items.map((n,y)=>{let N="";return n.enclosure&&n.enclosure.link?N=n.enclosure.link:n.media&&n.media.content&&n.media.content.url?N=n.media.content.url:n.thumbnail&&(N=n.thumbnail),{id:`rss-${y}`,title:n.title,url:n.link,published_at:n.pubDate,description:n.description||n.contentSnippet||"",author:n.author,tags:n.categories||[],image:N}});r(g);const w={};if(l&&l.customContent){const n={};g.forEach((y,N)=>{n[y.url]=N}),l.customContent.forEach(y=>{const N=n[y.url];N!==void 0&&(w[N.toString()]=!0)})}else g.forEach((n,y)=>{w[y.toString()]=!0});c(w)}catch(f){h(`Failed to fetch RSS articles: ${f instanceof Error?f.message:"Unknown error"}`),console.error("Error fetching RSS articles:",f);const k=[{id:"sample-1",title:"Sample Article 1",url:"https://example.com/article1",published_at:new Date().toISOString(),description:"This is a sample article description",author:"Author 1",tags:["tech","programming"],image:""},{id:"sample-2",title:"Sample Article 2",url:"https://example.com/article2",published_at:new Date(Date.now()-864e5).toISOString(),description:"This is another sample article description",author:"Author 2",tags:["web","design"],image:""}];r(k);const g={};l&&l.customContent?g[0]=!0:k.forEach((w,n)=>{g[n.toString()]=!0}),c(g)}finally{u(!1)}},B=f=>{c(k=>({...k,[f]:!k[f]}))},U=()=>{try{const f=Object.entries(i).filter(([g,w])=>w).map(([g])=>t[parseInt(g)]);if(f.length===0){h("Please select at least one article");return}const k=f.map((g,w)=>({id:g.id,url:g.url,title:g.title,published_at:new Date(g.published_at).getTime(),tags:g.tags||[],reactions:0,comments:0,image_url:g.image||"",source:"custom"}));if(l){const g={...l,customContent:k,component:oe},w=p.map(n=>n.value===l.value?g:n);v(w),o(),alert(`Successfully updated custom card with ${f.length} article(s)!`)}else{const g={feedUrl:a.url,label:`${a.title} - Custom`,value:`custom-rss-${Date.now()}`,analyticsTag:`custom-rss-${Date.now()}`,link:a.url,type:"rss",icon:"ðŸ“°",customContent:k,component:oe};v([...p,g]);const w={id:C.length,name:g.value,type:"rss"};L([...C,w]),o(),alert(`Successfully created custom card with ${f.length} article(s)!`)}}catch(f){h("Error creating custom card. Please try again."),console.error("Error creating custom card:",f)}};return e.jsx(ae,{showModal:s,onClose:o,header:{title:l?"Edit RSS Content":"RSS Content Editor"},children:e.jsxs("div",{className:"rss-content-editor",children:[e.jsxs("div",{className:"feed-info",children:[e.jsx("h3",{children:a.title}),e.jsx("p",{children:a.url})]}),j&&e.jsx("div",{className:"error-message",children:j}),d?e.jsx("div",{className:"loading",children:"Loading articles..."}):e.jsxs("div",{className:"articles-list",children:[e.jsx("h4",{children:l?"Edit Articles for Custom Card":"Select Articles for Custom Card"}),e.jsx("div",{className:"articles-container",children:t.map((f,k)=>e.jsx("div",{className:`article-item ${i[k.toString()]?"selected":""}`,children:e.jsxs("div",{className:"article-header",children:[e.jsx("input",{type:"checkbox",checked:i[k.toString()]||!1,onChange:()=>B(k.toString())}),e.jsxs("div",{className:"article-info",children:[e.jsx("h5",{children:f.title}),e.jsx("p",{className:"article-url",children:f.url}),e.jsx("p",{className:"article-description",children:f.description}),f.author&&e.jsxs("p",{className:"article-author",children:["By ",f.author]}),f.tags&&e.jsx("div",{className:"article-tags",children:f.tags.map((g,w)=>e.jsx("span",{className:"tag",children:g},w))})]})]})},k))}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{onClick:U,disabled:Object.values(i).filter(Boolean).length===0,className:"create-card-button",children:l?"Update Card":"Create Custom Card"}),e.jsx("button",{onClick:o,className:"cancel-button",children:"Cancel"})]})]})]})})},Ls=async s=>{try{const a=(await ce.get(s,{headers:{"User-Agent":"Mozilla/5.0 (compatible; RSS Feed Detector/1.0)"}})).data,l=[],t=/<link[^>]*rel=["'](alternate|feed)["'][^>]*href=["']([^"']+)["'][^>]*type=["'](application\/rss\+xml|application\/atom\+xml|application\/rdf\+xml|application\/xml\+rss|text\/xml)[^>]*>/gi;let r;for(;(r=t.exec(a))!==null;){const[,,c,d]=r;if(c){const u=new URL(c,s).href,j=r[0].match(/title=["']([^"']+)["']/i),h=j?j[1]:`RSS Feed (${d})`;l.push({url:u,title:h,type:d})}}const i=["/rss","/rss.xml","/feed","/feed.xml","/atom.xml","/rssfeed","/rss/feed.xml"];for(const c of i)try{const d=new URL(c,s).href;l.some(u=>u.url===d)||l.push({url:d,title:`RSS Feed (${c})`,type:"application/rss+xml"})}catch{}return l}catch(o){return console.error("Error detecting RSS feeds:",o),[]}},Ms=async s=>{try{const a=(await ce.get(s,{headers:{"User-Agent":"Mozilla/5.0 (compatible; RSS Feed Validator/1.0)"}})).data;return a.includes("<rss")||a.includes("<feed")||a.includes("<rdf:RDF")||a.includes("<?xml")}catch(o){return console.error("Error validating RSS feed:",o),!1}},Us=({isOpen:s,onClose:o,urlToCheck:a})=>{const[l,t]=x.useState(a||""),[r,i]=x.useState(!1),[c,d]=x.useState([]),[u,j]=x.useState({}),[h,p]=x.useState({}),[v,C]=x.useState(null),[L,F]=x.useState(!1),[B,U]=x.useState(null),{userCustomCards:f,setUserCustomCards:k,cards:g,setCards:w}=T();x.useEffect(()=>{a&&(t(a),n(a))},[a]);const n=async m=>{if(!m){C("Please enter a URL");return}m.startsWith("http")||(m="https://"+m);try{i(!0),C(null),d([]),j({}),p({}),new URL(m);const D=await Ls(m);if(D.length===0){C("No RSS feeds found on this website");return}d(D);const R={};for(const b of D)try{const M=await Ms(b.url);R[b.url]=M}catch{R[b.url]=!1}j(R);const E={};D.forEach(b=>{E[b.url]=R[b.url]||!1}),p(E)}catch(D){D instanceof Error?C(`Error: ${D.message}`):C("An unknown error occurred")}finally{i(!1)}},y=async()=>{try{const m=c.filter(R=>h[R.url]);if(m.length===0){C("Please select at least one feed to add");return}i(!0);const D=[];for(const R of m)try{const E=await xe(R.url),b={feedUrl:R.url,label:E.title||R.title,value:E.title.toLowerCase().replace(/\s+/g,"-")||`rss-${Date.now()}`,analyticsTag:E.title.toLowerCase().replace(/\s+/g,"-")||`rss-${Date.now()}`,link:E.link||R.url,type:"rss",icon:E.icon||"ðŸ“°"};D.push(b),pe(b.value)}catch(E){console.error(`Error processing feed ${R.url}:`,E)}if(D.length>0){k([...f,...D]);const R=D.map((E,b)=>({id:g.length+b,name:E.value,type:"rss"}));w([...g,...R])}o(),alert(`Successfully added ${D.length} RSS feed(s)!`)}catch(m){C("Error adding RSS feeds. Please try again."),console.error("Error adding RSS feeds:",m)}finally{i(!1)}},N=m=>{p(D=>({...D,[m]:!D[m]}))},A=m=>{U(m),F(!0)};return e.jsxs(ae,{showModal:s,onClose:o,header:{title:"RSS Feed Finder"},children:[e.jsx("div",{className:"rss-finder-modal",children:e.jsxs("div",{className:"rss-finder-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"website-url",children:"Website URL"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{id:"website-url",type:"text",value:l,onChange:m=>t(m.target.value),placeholder:"https://example.com",disabled:r}),e.jsx("button",{onClick:()=>n(l),disabled:r||!l,className:"detect-button",children:r?"Detecting...":"Find Feeds"})]})]}),v&&e.jsx("div",{className:"error-message",children:v}),c.length>0&&e.jsxs("div",{className:"feeds-list",children:[e.jsxs("h3",{children:["Found ",c.length," RSS Feed(s)"]}),e.jsx("div",{className:"feeds-container",children:c.map((m,D)=>e.jsxs("div",{className:`feed-item ${h[m.url]?"selected":""}`,children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("input",{type:"checkbox",checked:h[m.url]||!1,onChange:()=>N(m.url),disabled:!u[m.url]}),e.jsxs("div",{className:"feed-info",children:[e.jsx("h4",{children:m.title}),e.jsx("p",{className:"feed-url",children:m.url})]})]}),e.jsxs("div",{className:"feed-status",children:[u[m.url]===!0&&e.jsx("span",{className:"status valid",children:"âœ“ Valid"}),u[m.url]===!1&&e.jsx("span",{className:"status invalid",children:"âœ— Invalid"}),u[m.url]===void 0&&e.jsx("span",{className:"status checking",children:"Checking..."}),e.jsx("button",{onClick:()=>A(m),className:"edit-content-button",disabled:!u[m.url],children:"Edit Content"})]})]},m.url))}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{onClick:y,disabled:r||Object.values(h).filter(Boolean).length===0,className:"add-feeds-button",children:r?"Adding...":"Add Selected Feed(s)"}),e.jsx("button",{onClick:o,className:"cancel-button",children:"Cancel"})]})]})]})}),e.jsx(ve,{isOpen:L,onClose:()=>F(!1),feed:B||{url:"",title:"",type:""}})]})},$s=()=>{const{cards:s,setCards:o,userCustomCards:a,setUserCustomCards:l}=T(),[t,r]=x.useState(),[i,c]=x.useState(),[d,u]=x.useState(!1),j=async()=>{if(!t){c("Please provide an RSS Feed URL");return}if(!je(t)){c("Invalid RSS Feed URL. Please check and try again");return}u(!0);try{const h=await xe(t);let p=h.title.toLowerCase();if(a.some(F=>F.link===h.link)){c("RSS Feed already exists");return}let v={feedUrl:t,label:h.title,value:p,analyticsTag:p,link:h.link,type:"rss",icon:h.icon};l([...a,v]);const C=[...s],L={id:Math.max(...C.map(F=>F.id),C.length-1)+1,name:v.value,type:v.type};o([...C,L]),rs([...C,L].map(F=>F.name)),pe(v.value),r(""),c("RSS Feed Added")}catch{c("Error occured. Please check and try again")}finally{u(!1)}};return e.jsxs("div",{className:"settingRow",children:[e.jsx("p",{className:"settingTitle",children:"RSS Feed URL"}),e.jsxs("div",{className:"settingContent",children:[e.jsxs("div",{className:"form",children:[e.jsx("input",{type:"text",value:t||"",onChange:h=>r(h.target.value),placeholder:"https://url.com/rss/feed"}),d?e.jsx(ns,{color:"#A9B2BD",loading:d,size:6}):e.jsx("div",{children:e.jsx(I,{startIcon:e.jsx(ls,{}),size:"small",className:"rssButton",onClick:j,children:"Add"})})]}),i&&e.jsx("div",{className:"settingHint",children:e.jsx("p",{children:i})})]})]})},qs=()=>{var U,f,k,g,w;const{cards:s,setCards:o,userCustomCards:a,setUserCustomCards:l}=T(),[t,r]=x.useState({showModal:!1,option:void 0}),[i,c]=x.useState(!1),[d,u]=x.useState(!1),[j,h]=x.useState(null),p=x.useRef(null),v=x.useMemo(()=>[...se.map(n=>({label:n.label,value:n.value,icon:n.icon,removeable:!0})),...a.map(n=>({label:n.label,value:n.value,removeable:!0,icon:n.icon?e.jsx("img",{src:n.icon,alt:""}):void 0,actions:[{label:"Edit Content",onClick:()=>B(n)}]}))].sort((n,y)=>n.label>y.label?1:-1),[a]),C=()=>{const n={cards:s,userCustomCards:a,exportDate:new Date().toISOString(),version:"1.0"},y=JSON.stringify(n,null,2),N=`data:application/json;charset=utf-8,${encodeURIComponent(y)}`,A=`devare-sources-${new Date().toISOString().slice(0,10)}.json`,m=document.createElement("a");m.setAttribute("href",N),m.setAttribute("download",A),m.click()},L=()=>{var n;(n=p.current)==null||n.click()},F=n=>{var A;const y=(A=n.target.files)==null?void 0:A[0];if(!y)return;const N=new FileReader;N.onload=m=>{var D;try{const R=(D=m.target)==null?void 0:D.result,E=JSON.parse(R);if(!E.cards||!E.userCustomCards)throw new Error("Invalid file format");o(E.cards),l(E.userCustomCards),p.current&&(p.current.value=""),alert("Sources imported successfully!")}catch(R){console.error("Error importing sources:",R),alert("Error importing sources. Please check the file format.")}},N.readAsText(y)},B=n=>{h(n),u(!0)};return e.jsx(z,{title:"Sources",description:"Your feed will be tailored by following the sources you are interested in.",children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sources-actions",children:[e.jsx(I,{startIcon:e.jsx(ue,{}),onClick:L,children:"Import Sources"}),e.jsx(I,{startIcon:e.jsx(me,{}),onClick:C,children:"Export Sources"}),e.jsx(I,{onClick:()=>c(!0),children:"Find RSS Feeds"}),e.jsx("input",{type:"file",ref:p,onChange:F,accept:".json",style:{display:"none"}})]}),e.jsx(Us,{isOpen:i,onClose:()=>c(!1)}),e.jsx(ve,{isOpen:d,onClose:()=>u(!1),feed:j?{url:j.feedUrl||"",title:j.label,type:"rss"}:{url:"",title:"",type:""},existingCard:j||void 0}),e.jsx(Q,{showModal:t.showModal,title:`Confirm ${(U=t.option)!=null&&U.isCustom?"delete":"remove"} source: ${(f=t.option)==null?void 0:f.label}`,description:`Are you sure you want to ${(k=t.option)!=null&&k.isCustom?"delete":"remove"} ${(g=t.option)==null?void 0:g.label} source? ${(w=t.option)!=null&&w.isCustom?"This action cannot be undone.":"You can add it back anytime."}`,onClose:()=>r({showModal:!1,option:void 0}),onConfirm:()=>{if(t.option){if(t.option.isCustom){const n=a.filter(N=>{var A;return N.value!==((A=t.option)==null?void 0:A.value)}),y=s.filter(N=>{var A;return N.name!==((A=t.option)==null?void 0:A.value)});o(y),l(n)}else{const n=s.filter(y=>{var N;return y.name!==((N=t.option)==null?void 0:N.value)});o(n)}r({showModal:!1,option:void 0})}}}),e.jsx(K,{canSelectMultiple:!0,options:v,defaultValues:s.map(n=>n.name),onRemove:n=>{r({showModal:!0,option:{...n,isCustom:a.some(y=>y.value===n.value)}})},onChange:(n,y)=>{const N=y.map(b=>b.value),A=new Map(s.map(b=>[b.name,b])),m=new Set(N),D=s.filter(b=>m.has(b.name)),R=N.filter(b=>!A.has(b)).map((b,M)=>se.find(P=>P.value===b)?{id:s.length+M,name:b,type:"supported"}:a.find(P=>P.value===b)?{id:s.length+M,name:b,type:"rss"}:null).filter(Boolean),E=[...D,...R];o(E),n.action=="ADD"?os(n.option.value):is(n.option.value)}}),e.jsx("hr",{}),e.jsxs(e.Fragment,{children:[e.jsx("header",{children:e.jsxs("div",{className:"settingsHeader",children:[e.jsx("h3",{className:"title",children:"Add new Source"}),e.jsx("p",{className:"description",children:"Can't find your favorite source? Add its RSS feed URL here and it will be available in your feed."})]})}),e.jsx($s,{})]})]})})},Ks=()=>{const{userSelectedTags:s,setTags:o}=T(),{supportedTags:a}=cs(),l=a.map(t=>({label:t.label,value:t.value})).sort((t,r)=>t.label>r.label?1:-1);return e.jsx(z,{title:"Topics",description:"Your feed will be tailored by following the technologies you are interested in.",children:e.jsx(K,{canSelectMultiple:!0,options:l,defaultValues:s.map(t=>t.value),onChange:(t,r)=>{const i=r.map(c=>a.find(d=>d.value===c.value)).filter(Boolean)||[];o(i),t.action=="ADD"?ds(t.option.value):us(t.option.value)}})})};export{vs as BookmarkItem,Ys as BookmarkSettings,Js as GeneralSettings,Ws as SearchEngineSettings,qs as SourceSettings,Ks as TopicSettings};
//# sourceMappingURL=index-CrAS1X37.js.map
