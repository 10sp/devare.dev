import{u as x,au as y,aM as _,aN as R,aO as E}from"./index-CR7iXtCZ.js";import{r as f,k as d}from"./core-Dg4AQqgP.js";import"./utils-272-bJLf.js";import"./ui-BCbqmSXn.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="cfce27cd-e728-4e58-b070-6f0a22884a71",e._sentryDebugIdIdentifier="sentry-dbid-cfce27cd-e728-4e58-b070-6f0a22884a71")}catch{}function I(){const e=new Map;function n({root:a,rootMargin:i,threshold:c}){let s=e.get(a);s||(s=new Map,e.set(a,s));const l=JSON.stringify({rootMargin:i,threshold:c});let o=s.get(l);if(!o){const r=new Map;o={observer:new IntersectionObserver(v=>{v.forEach(t=>{const u=r.get(t.target);u==null||u(t)})},{root:a,rootMargin:i,threshold:c}),entryCallbacks:r},s.set(l,o)}return{observe:(r,b)=>{o.entryCallbacks.set(r,b),o.observer.observe(r)},unobserve:r=>{o.entryCallbacks.delete(r),o.observer.unobserve(r)}}}return{getObserver:n}}var N="0px",O=[0],k=I();function w(e){const n=(e==null?void 0:e.rootMargin)??N,a=(e==null?void 0:e.threshold)??O,i=f.useRef(null),c=f.useRef(null),s=f.useRef(null),[l,o]=f.useState(),r=f.useCallback(()=>{function t(){const g=s.current,p=i.current;p&&(g==null||g.unobserve(p),o(void 0)),s.current=null}function u(){const g=i.current;if(!g)return;const p=k.getObserver({root:c.current,rootMargin:n,threshold:a});p.observe(g,m=>{o(m)}),s.current=p}t(),u()},[n,a]),b=f.useCallback(t=>(i.current=t,r(),()=>{i.current=null,r()}),[r]),v=f.useCallback(t=>(c.current=t,r(),()=>{c.current=null,r()}),[r]);return[b,{entry:l,rootRef:v}]}var C=w;function L(e){var r;const{once:n,...a}=e??{},[i,c]=C(a),s=!!((r=c.entry)!=null&&r.isIntersecting),[l,o]=f.useState(s);return n&&s&&!l&&o(!0),[i,{...c,isVisible:n?l:s}]}var T=L,j=100;function D({loading:e,hasNextPage:n,onLoadMore:a,rootMargin:i,disabled:c,delayInMs:s=j}){const l=f.useRef(a),[o,{rootRef:r,isVisible:b}]=T({rootMargin:i});f.useEffect(()=>{l.current=a},[a]);const v=!c&&!e&&b&&n;return f.useEffect(()=>{if(v){const t=setTimeout(()=>{l.current()},s);return()=>{clearTimeout(t)}}},[v,s]),[o,{rootRef:r}]}var S=D;const V=()=>{const{userSelectedTags:e}=x(),{data:n,isLoading:a,isInitialLoading:i,hasNextPage:c,isError:s,error:l,isFetchingNextPage:o,fetchNextPage:r}=y({tags:e.map(t=>t.label.toLocaleLowerCase()),config:{select:t=>({...t,pages:t.pages.map((u,g)=>{const p=u.data,m=[];return p.forEach((h,F)=>{m.push(h)}),{...u,data:m}})})}}),[b,{rootRef:v}]=S({loading:a,hasNextPage:!!c,onLoadMore:()=>{r(),E()},disabled:!!l,rootMargin:"0px 0px 100% 0px"});return i?d.jsx("div",{className:"feed",children:Array.from({length:10}).map((t,u)=>d.jsxs("div",{className:"feedItem placeholder",children:[d.jsx("div",{className:"image"}),d.jsx("div",{className:"line"}),d.jsx("div",{className:"smallLine"})]},`loading-${u}`))}):d.jsxs("div",{ref:v,className:"feed scrollable",style:{overflow:"auto",maxHeight:"100%"},children:[((n==null?void 0:n.pages.flatMap(t=>t.data))||[]).map((t,u)=>d.jsx(_,{item:t,index:u,analyticsTag:"feed",className:"feedItem"},t.id)),c&&d.jsx("div",{className:"feedLoading",ref:b,children:d.jsx(R.PropagateLoader,{color:"#A9B2BD",loading:!0,size:8})}),o&&s&&d.jsx("div",{children:"Error while loading more pages"})]})};export{V as Feed,_ as FeedItem,y as useGetFeed};
//# sourceMappingURL=index-DKjK6kCX.js.map
